<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <title>Buttons - SB Admin Pro</title>
    <link href="css/styles.css" rel="stylesheet" />
    <link rel="icon" type="image/x-icon" href="assets/img/favicon.png" />
    <script data-search-pseudo-elements defer src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/js/all.min.js" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/feather-icons/4.24.1/feather.min.js" crossorigin="anonymous"></script>
  </head>
  <body class="nav-fixed">
    <nav class="topnav navbar navbar-expand shadow navbar-light bg-white" id="sidenavAccordion"></nav>
    <div id="layoutSidenav">
      <div id="layoutSidenav_nav">
        <nav class="sidenav shadow-right sidenav-light"></nav>
      </div>
      <div id="layoutSidenav_content">
        <main>
          <div class="page-header pb-10 page-header-dark bg-gradient-primary-to-secondary">
            <div class="container-fluid">
              <div class="page-header-content"></div>
            </div>
          </div>
          <div class="container-fluid mt-n10">
            <div id="default">
              <div class="card mb-4">
                <div class="card-header"></div>
                <div class="card-body">
                  <div class="sbp-preview mb-4">
                    <div class="sbp-preview-content">
                      <button id="payment-button" class="btn btn-primary mr-2 my-1" type="button">Pagar</button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </main>
        <footer class="footer mt-auto footer-light"></footer>
      </div>
    </div>
    <script src="https://code.jquery.com/jquery-3.4.1.min.js" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
    <script type="text/javascript">
      $("#payment-button").click(function() {
        submit();
      });

      //let url = "https://backoffice.pharospayments.com/api/v1/transaction_requests"
      let url = "https://backoffice.pharospayments.com/api/v1/transaction_requests"
      let apiKey = "68b0180a311e00933daef91cfbf04d9c0e2354c991a0e8053abf7d3f80b1aad7"

      function submit() { 
        let params = {
          transaction_request: {
            currency_code: "484", 
            terminal_id: "1754",
            amount: "99.00",
            amount_base_0: "0.00",
            amount_base_min: "88.39",
            amount_base_basic: "88.39",
            amount_tax: "10.61",
            cancel_url: "http://example.com/cancel.html",
            success_url: "http://example.com/success.html",
            error_url: "http://example.com/error.html",     
            reference: "Reference",
            email: "ignacio@eagerworks.com",
            phone: '123123',
            name: "Nacho",
            api_key: apiKey
          }
        }

        post(url, params);
      }

      function post(path, params) {
        var form = document.createElement("form");
        form.setAttribute("method", "post");
        form.setAttribute("action", path);

        params = params["transaction_request"]
        for (var key in params) {
          if (params.hasOwnProperty(key)) {
            var hiddenField = document.createElement("input");
            hiddenField.setAttribute("type", "hidden");
            hiddenField.setAttribute("name", `transaction_request[${key}]`);
            hiddenField.setAttribute("value", params[key]);
            form.appendChild(hiddenField);
          }
        }

        document.body.appendChild(form);
        form.submit();
      }
    </script>
  </body>
</html>
